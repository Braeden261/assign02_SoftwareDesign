<!DOCTYPE html>
<html>
<head>
<script>

const NUM_PICKUPS = 15;
const NUM_ENEMIES = 4;

var c;
var ctx;
var img;
var player;
var enemies = [];
var pickUps = [];
var pnts = 0;
var gameRun = true;
var gameWin = false;

class Char{
  
  constructor(_x, _y, _spd, _img) {

    this.iX = _x;
    this.iY = _y;
    this.iSpd = _spd;
    this.sprite = new Image();
    this.sprite.src = _img;
    this.draw = true;

  }
}

function Collision(objA, objB){
	var c;
    var a = Math.pow(objA.iX - objB.iX, 2);
    var b = Math.pow(objA.iY - objB.iY, 2);
    c = Math.sqrt(a+b);
   	console.log(c);
    if (c < 75){
    	return true;
    }
    else{
    	return false;
    }
}


function Init(){

   c = document.getElementById("myCanvas");
   ctx = c.getContext("2d");
   
   player = new Char(0, 200, 5, "http://2.bp.blogspot.com/-W5YWFyaZXl0/U_4xPYwNR8I/AAAAAAAAFr8/8Cl2ZJO4kH0/s1600/linknintendo.png");
   
   for(i = 0; i < NUM_PICKUPS; i++){
    pickUps[i] = new Char(i* 75 + 30, i* 30, 0, "http://pixelartmaker.com/art/14c5e7f57a80a91.png")
   }
   for(i = 0; i < NUM_ENEMIES; i++){
    enemies[i] = new Char(i*150, i*50, 1, "https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/The_Legend_of_Zelda_-_NES_-_Red_octorok.svg/85px-The_Legend_of_Zelda_-_NES_-_Red_octorok.svg.png")
   }

   setInterval(Draw, 30);
   setInterval(Collision(player, enemies), 30);
   
   window.addEventListener('keydown', function(event)
   {
	   KeyInput();
   }, false);
   
   //Update();
   
} 

function Draw()
{
    ctx.clearRect(0,0,c.width,c.height);
    
    //ctx.drawImage(img,x,y);
    for (i = 0; i < NUM_PICKUPS; i++){
        if (pickUps[i].draw == true){
            ctx.drawImage(pickUps[i].sprite,pickUps[i].iX - 135,pickUps[i].iY - 115);
        }
    }
    if (player.draw == true){
        ctx.drawImage(player.sprite,player.iX - 93,player.iY - 100);
    }
    for (i = 0; i < NUM_ENEMIES; i++){
        if (enemies[i].draw == true){
            ctx.drawImage(enemies[i].sprite,enemies[i].iX,enemies[i].iY);
        }
    }
}

function Update(){
    var hit;
	points.innerHTML = pnts;
    for (i = 0; i < NUM_PICKUPS; i++){
        var hit = Collision(player, pickUps[i]);
        if (hit == true && pickUps[i].draw == true){
            pnts++;
            pickUps[i].draw = false;
        }
    }
    for(i = 0; i < NUM_ENEMIES; i++){
        hit = Collision(player, enemies[i]);
        gameCheck(hit);
    }

    
    
}

function gameCheck(hit){

    if (pnts >= 15){
        gameRun = false;
        gameWin = true;
        points.innerHTML = "You Win";
    }
    else if (hit == true){
        gameRun = false;
        gameWin = false;
        points.innerHTML = "You Lose";
    }
}


function KeyInput()
{
    if (gameRun == true){
        switch (event.keyCode) 
        {
            case 37: // Left
                player.iX -= player.iSpd;
                break;
            case 38: // Up
                player.iY -=  player.iSpd;
                break;
            case 39: // Right
                player.iX +=  player.iSpd;
                break;
            case 40: // Down
                player.iY +=  player.iSpd;
                break;
        }
        Update();
    }
}

function GameLoop(){

    Init();

    
}


</script>
</head>
  <body onload="GameLoop()">
    <p>Game:</p>
    <canvas id="myCanvas" width="1200" height="700" style="border:1px solid #d3d3d3;">
    	Your browser does not support the HTML5 canvas tag.
    </canvas>
    <p>Points:</p> 
    <div id="points"></div>
    
  </body>
</html>